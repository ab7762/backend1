<!-- Socket.io -client joka on tehty ilman mitään sovelluskehystä tai apukirjastoa-->
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>client</title>
    <!-- socket.io-kirjasto löytyy node_modules kansiosta tällä polkumäärityksellä
        se voitaisiin hakea myös webistä CDN:stä-->
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
      //Luodaan clientin socket joka yhdistetään serveriin
      const socket = io.connect('http://localhost:3010');

      socket.on('welcome', function (data) {
        document.getElementById('welcome').innerHTML =
          'Tervetuloa peliin: ' + data.bold();
        user = data;

        console.log(user);
      });
      //Joka kerta kun 'message_to_client' -tapahtuma saapuu serveriltä
      //laitetaan data diviin joka id on chat. Lisätään myös vanhat viestit perään
      socket.on('pieni', (data) => {
        document.getElementById('chat').innerHTML =
          document.getElementById('chat').innerHTML +
          '<br>' +
          data.user.bold() +
          ':' +
          data.value.bold() +
          ' ' +
          '-Liian pieni';
      });
      socket.on('suuri', (data) => {
        document.getElementById('chat').innerHTML =
          document.getElementById('chat').innerHTML +
          '<br>' +
          data.user.bold() +
          ':' +
          data.value.bold() +
          ' ' +
          '-Liian suuri';
      });
      socket.on('voitto', (data) => {
        document.getElementById('chat').innerHTML =
          data.user.bold() +
          ' ' +
          'Arvasi' +
          ' ' +
          'Oikein' +
          ' ' +
          'Luvun' +
          ' ' +
          data.value.bold() +
          ' ' +
          'Ja voitti pelin!';
      });
      function sendMessage() {
        //otetaan teksti-inputin sisältö talteen
        const contents = {
          value: document.getElementById('message_input').value,
          user: user,
        };
        console.log(contents);
        //emitoidaan tapahtuma 'message_to_server' jolla data lähtee avain-arvo parina
        socket.emit('message_to_server', contents);
      }
    </script>
  </head>
  <body>
    <div id="welcome" style="margin-bottom: 1em"></div>

    <h1>Arvaa numero väliltä 1 - 100</h1>
    <input type="number" id="message_input" />
    <button onclick="sendMessage()">send</button>
    <!-- chattiviestit tulevat tähän-->
    <div id="chat"></div>
    <div id="voitto"></div>
  </body>
</html>
